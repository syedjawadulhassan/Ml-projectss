# Pneumonia Detection: Deep Learning Based Medical Image Classification System

A production-ready Flask application that detects pneumonia from chest X-ray images using **ResNet50** transfer learning and serves predictions with **Grad-CAM** heatmap visualization.

## Tech Stack

- **Backend:** Python 3.10+, Flask
- **ML/DL:** PyTorch, torchvision, ResNet50
- **Frontend:** HTML5, CSS3, Bootstrap 5, Vanilla JS
- **Utilities:** matplotlib, scikit-learn, OpenCV, PIL

## Project Structure

```
pneumonia-detection-flask/
├── app.py              # Flask app, routes, upload, prediction
├── model/
│   └── pneumonia_model.pth   # Generated by train_model.py
├── static/
│   ├── style.css
│   └── uploads/
├── templates/
│   ├── index.html
│   ├── about.html
│   ├── upload.html
│   └── result.html
├── train_model.py      # Full training pipeline
├── utils.py            # Preprocessing, Grad-CAM, model load
├── requirements.txt
└── README.md
```

## Dataset

The project already includes the folder structure:

```
dataset/
   train/
      NORMAL/
      PNEUMONIA/
   val/
      NORMAL/
      PNEUMONIA/
   test/
      NORMAL/
      PNEUMONIA/
```

**Download the Kaggle images into these folders:**

1. Install Kaggle CLI: `pip install kaggle`
2. Add your API key: save `kaggle.json` to `%USERPROFILE%\.kaggle\` (Windows) or `~/.kaggle/` (Linux/Mac). Get the key from [Kaggle Settings](https://www.kaggle.com/settings) → Create New Token.
3. Accept the dataset rules once: [Chest X-Ray Pneumonia](https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia).
4. Run the setup script:

   ```bash
   python setup_dataset.py
   ```
   Or on Windows double-click **run_setup_dataset.bat**.

The script downloads the dataset from Kaggle and fills `dataset/train`, `dataset/val`, and `dataset/test` with NORMAL and PNEUMONIA images.

To use a dataset already located elsewhere:

```bash
python train_model.py --data /path/to/dataset
```

## Setup

1. **Create virtual environment (recommended):**

   ```bash
   python -m venv venv
   venv\Scripts\activate   # Windows
   # source venv/bin/activate  # Linux/Mac
   ```

2. **Install dependencies:**

   ```bash
   pip install -r requirements.txt
   ```

3. **Train the model** (after placing the dataset):

   ```bash
   python train_model.py
   ```

   Optional arguments:
   - `--data PATH` — dataset root
   - `--epochs N` — number of epochs (default: 20)
   - `--batch_size N` — batch size (default: 32)
   - `--lr FLOAT` — learning rate (default: 1e-3)
   - `--patience N` — early stopping patience (default: 5)
   - `--save_plots DIR` — directory for training curves and confusion matrix

   The trained model is saved to `model/pneumonia_model.pth`.

4. **Run the Flask app:**

   ```bash
   python app.py
   ```

   Open http://127.0.0.1:5000 in your browser.

## Features

- **Training:** ResNet50 transfer learning, data augmentation, early stopping, LR scheduler, metrics (accuracy, precision, recall, F1, confusion matrix), training plots.
- **Web:** Home, About, Upload, Result pages; secure file upload; image preview; loading state; green/red result alerts.
- **Grad-CAM:** Heatmap visualization on the result page showing where the model focused.

## Disclaimer

This application is for **research and educational purposes only**. It does not replace professional medical diagnosis. Always consult a healthcare provider for medical decisions.
